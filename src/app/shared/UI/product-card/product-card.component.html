<p-card class="product-card">
    <ng-template pTemplate="header">
        <div class="image-container">
            <img [src]="product.imageCover" [alt]="product.title" class="product-image" />

            <!-- Discount Badge -->
            <div class="discount-badge" *ngIf="hasDiscount()">
                <span>{{ calculateDiscountPercentage() }}% OFF</span>
            </div>

            <!-- Stock Badge -->
            <div class="stock-badge" [class.out-of-stock]="product.quantity === 0">
                {{ product.quantity > 0 ? 'In Stock' : 'Out of Stock' }}
            </div>
        </div>
    </ng-template>

    <div class="card-body">
        <h3 class="product-title" [title]="product.title">{{ product.title }}</h3>
        <p class="product-brand">{{ product.brand.name }}</p>
        <p class="product-desc">
            {{ product.description | slice: 0: 80 }}...
        </p>

        <!-- Price Section with Discount -->
        <div class="product-price-section">
            <div class="price-wrapper">
                <span class="current-price">
                    EGP {{ product.priceAfterDiscount || product.price }}
                </span>
                <span class="original-price" *ngIf="hasDiscount()">
                    EGP {{ product.price }}
                </span>
            </div>
            <div class="savings" *ngIf="hasDiscount()">
                Save EGP {{ product.price - (product.priceAfterDiscount || 0) | number: '1.2-2' }}
            </div>
        </div>

        <!-- Rating Section -->
        <div class="product-rating">
            <i class="pi pi-star-fill"></i>
            <span class="rating-value">{{ product.ratingsAverage }}</span>
            <span class="rating-count">({{ product.ratingsQuantity }})</span>
        </div>
    </div>

    <ng-template pTemplate="footer">
        <div class="card-actions">
            <p-button
                label="Add to Cart"
                icon="pi pi-shopping-cart"
                [disabled]="product.quantity === 0"
                styleClass="add-cart-btn"
                (onClick)="handleAddToCart(product._id)">
            </p-button>

            <p-button
                icon="pi pi-info-circle"
                [outlined]="true"
                severity="secondary"
                styleClass="details-btn"
                [routerLink]="['/user/productDetails', product._id]">
            </p-button>
        </div>
    </ng-template>
</p-card>
